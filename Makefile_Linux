include Makefile_Common

SRCS = src/main.cpp

OBJ_DIR = src/obj

OBJS = $(patsubst src/%.cpp,$(OBJ_DIR)/%.o,$(SRCS))

CC = g++

LINKER_FLAGS = -lSDL2 -lSDL2_image -lSDL2_ttf

EXE = run

all : $(SRCS) $(OBJ_DIR) header $(OBJS) submodules $(EXE)

$(OBJ_DIR) :
	@mkdir $(OBJ_DIR)

header :
	@printf "$(LABEL_COLOR)╔══════════[Main]═══════════$(NO_COLOR)\n"

$(OBJS) : CMD = $(CC) $(COMPILER_FLAGS) -c $< -o $@

$(OBJS) : $(OBJ_DIR)/%.o : src/%.cpp
	@printf "$(LABEL_COLOR)╠═$(NO_COLOR)";$(PRINT)

submodules :
	@printf "$(LABEL_COLOR)╚$(NO_COLOR)\n"
	@printf "$(LABEL_COLOR)╔═════════[PugiXML]═════════$(NO_COLOR)\n"
	@$(MAKE) --no-print-directory -C src/pugixml
	@printf "$(LABEL_COLOR)╚$(NO_COLOR)\n"
	@printf "$(LABEL_COLOR)╔══════════[Grid]═══════════$(NO_COLOR)\n"
	@$(MAKE) --no-print-directory -C src/grid
	@printf "$(LABEL_COLOR)╚$(NO_COLOR)\n"
	@printf "$(LABEL_COLOR)╔════════[Interface]════════$(NO_COLOR)\n"
	@$(MAKE) --no-print-directory -C src/interface
	@printf "$(LABEL_COLOR)╚$(NO_COLOR)\n"

$(EXE) : CMD = $(CC) $(OBJ_DIR)/*.o $(LINKER_FLAGS) -o $(EXE)

$(EXE) :
	@printf "$(LABEL_COLOR)╔═══[Linking executable]════$(NO_COLOR)\n"
	@printf "$(LABEL_COLOR)╠═$(NO_COLOR)";$(PRINT_EXE)
	@printf "$(LABEL_COLOR)╚$(NO_COLOR)\n"

clean : CMD = rm $(EXE) && rm -r src/obj

clean :
	@printf "$(LABEL_COLOR)╔════════[Cleaning]═════════$(NO_COLOR)\n"
	@printf "$(LABEL_COLOR)╠═$(NO_COLOR)";$(PRINT_EXE)
	@printf "$(LABEL_COLOR)╚$(NO_COLOR)\n"